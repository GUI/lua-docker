# AUTOMATICALLY GENERATED
# DO NOT EDIT THIS FILE DIRECTLY. Edit /Dockerfile.erb and run /update instead.

FROM debian:bookworm

RUN set -ex \
      && saved_apt_mark="$(apt-mark showmanual)" \
    && apt-get update \
    && apt-get install -y --no-install-recommends \
      ca-certificates \
      curl \
      gcc \
      libc6-dev \
      make \
              libreadline-dev \
                  libncurses-dev \
                        && curl -fsSL -o /tmp/lua.tar.gz "https://www.lua.org/ftp/lua-5.1.5.tar.gz" \
  && cd /tmp \
      && echo "2640fc56a795f29d28ef15e13c34a47e223960b0240e8cb0a82d9b0738695333 *lua.tar.gz" | sha256sum -c - \
    && mkdir /tmp/lua \
  && tar -xf /tmp/lua.tar.gz -C /tmp/lua --strip-components=1 \
  && cd /tmp/lua \
      && make linux \
    && make install \
      && cd / \
      && apt-mark auto '.*' > /dev/null \
    && if [ -n "$saved_apt_mark" ]; then \
      apt-mark manual $saved_apt_mark; \
    fi \
          && dpkg-query --show --showformat '${package}\n' | grep -P '^libreadline\d+$' | xargs apt-mark manual \
              && dpkg-query --show --showformat '${package}\n' | grep -P '^libncurses\d+$' | xargs apt-mark manual \
                  && apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false \
    && rm -rf /var/lib/apt/lists/* /var/lib/dpkg/*-old /var/cache/* /var/log/* \
    && rm -rf /tmp/lua /tmp/lua.tar.gz \
    && lua -v

CMD ["lua"]

LABEL org.opencontainers.image.source="https://github.com/GUI/lua-docker" \
  org.opencontainers.image.licenses="MIT"
